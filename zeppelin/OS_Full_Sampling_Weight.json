{"paragraphs":[{"text":"\nimport org.apache.spark.storage.StorageLevel\nval truthDFdup = spark.read.parquet(\"s3a://twine-profiling-datasets/profiling-master/weighted/trait=DT\").filter(\"upper(country) = 'US'\").select(upper($\"maid\").as(\"maid\"),col(\"dt\").as(\"adidtype\")).dropDuplicates().persist(StorageLevel.MEMORY_ONLY_SER)\ntruthDFdup.printSchema()\ntruthDFdup.show()","dateUpdated":"2018-09-28T06:14:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.storage.StorageLevel\ntruthDFdup: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [maid: string, adidtype: string]\nroot\n |-- maid: string (nullable = true)\n |-- adidtype: string (nullable = true)\n\n+--------------------+--------+\n|                maid|adidtype|\n+--------------------+--------+\n|0092C992A04043599...|       4|\n|01144B3F9E364170A...|       2|\n|019DC99543054D87A...|       2|\n|040CF80C1D39422B8...|       2|\n|0508B66449394490A...|       4|\n|05679C2D3E84436BB...|       2|\n|0710925B55DE4CD9A...|       2|\n|08164E5C6FFC455F8...|       4|\n|09122932DA634B79A...|       2|\n|0C1DBAF8721245F0B...|       2|\n|0CA39EF78A964DC79...|       4|\n|0DB4AA2E80EB4A41B...|       2|\n|0F67D81B2A5F4F6FA...|       2|\n|0F8A3F0121BE492AA...|       2|\n|0FA46D9FE0F744619...|       2|\n|109A34C79B644AE19...|       2|\n|1158EB82BECB48999...|       2|\n|11E01EE9CA6D47B38...|       4|\n|120FD86889CD43A0A...|       2|\n|1242EABE4AD84C768...|       2|\n+--------------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1538115270948_480278071","id":"20180918-121153_1178240691","dateCreated":"2018-09-28T06:14:30+0000","status":"ABORT","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:266","user":"anonymous","dateFinished":"2018-09-28T06:16:18+0000","dateStarted":"2018-09-28T06:14:41+0000"},{"text":"\ntruthDFdup.count()","dateUpdated":"2018-09-28T06:16:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: Long = 491730057\n"}]},"apps":[],"jobName":"paragraph_1538115270952_478739075","id":"20180918-130243_1500391212","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267","user":"anonymous","dateFinished":"2018-09-28T06:16:40+0000","dateStarted":"2018-09-28T06:16:23+0000"},{"text":"truthDFdup.createOrReplaceTempView(\"hwc\");","dateUpdated":"2018-09-28T06:16:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538115270952_478739075","id":"20180918-122339_2072905360","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268","user":"anonymous","dateFinished":"2018-09-28T06:16:41+0000","dateStarted":"2018-09-28T06:16:31+0000"},{"text":"%sql\n\nselect \n    count(*) total,\n    sum(case when adidtype = 2 then 1 else 0 end) Android,\n    sum(case when adidtype = 4 then 1 else 0 end) iOS\nfrom hwc\n","dateUpdated":"2018-09-28T06:14:30+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"total":"string","Android":"string","iOS":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"total\tAndroid\tiOS\n889298\t550564\t338734\n"}]},"apps":[],"jobName":"paragraph_1538115270953_478354326","id":"20180916-223414_1717416042","dateCreated":"2018-09-28T06:14:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"%sql\nselect count(distinct maid), count(maid), adidtype from hwc group by adidtype","dateUpdated":"2018-09-28T06:14:30+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":108,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count(DISTINCT maid)":"string","count(maid)":"string","adidtype":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT maid)\tcount(maid)\tadidtype\n2822478\t2822478\t4\n13658820\t13658820\t2\n"}]},"apps":[],"jobName":"paragraph_1538115270953_478354326","id":"20180918-125816_1275014803","dateCreated":"2018-09-28T06:14:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:270"},{"text":"\n\nval truthOSWfDf = truthDFdup.select($\"maid\", $\"adidtype\", when($\"adidtype\"===\"2\", 0.42073796).when($\"adidtype\"===\"4\", 0.80743794).as(\"weights\"))","dateUpdated":"2018-09-28T06:14:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"truthOSWfDf: org.apache.spark.sql.DataFrame = [maid: string, adidtype: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1538115270953_478354326","id":"20180921-222850_1000567792","dateCreated":"2018-09-28T06:14:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:271"},{"text":"//truthOSWfDf\ntruthDFdup.createOrReplaceTempView(\"truthset\")","dateUpdated":"2018-09-28T06:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538115270953_478354326","id":"20180917-224636_1513625308","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272","user":"anonymous","dateFinished":"2018-09-28T06:17:47+0000","dateStarted":"2018-09-28T06:17:47+0000"},{"text":"%sql\n\nselect count(distinct maid), count(maid), adidtype from truthset group by adidtype","dateUpdated":"2018-09-28T06:14:30+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":138,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count(DISTINCT maid)":"string","count(maid)":"string","adidtype":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT maid)\tcount(maid)\tadidtype\n2822478\t2822478\t4\n13658820\t13658820\t2\n"}]},"apps":[],"jobName":"paragraph_1538115270953_478354326","id":"20180917-224510_39652151","dateCreated":"2018-09-28T06:14:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:273"},{"text":"val testDF = spark.read.csv(\"s3a://twine-dev-athena/DeviceCharacteristics/testSet/\").select(col(\"_c0\").as(\"maid\"), col(\"pack\")).persist(StorageLevel.MEMORY_ONLY_SER)","dateUpdated":"2018-09-28T06:18:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"testDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [maid: string, pack: string]\n"}]},"apps":[],"jobName":"paragraph_1538115270954_479508573","id":"20180919-131101_2141255427","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274","user":"anonymous","dateFinished":"2018-09-28T06:18:13+0000","dateStarted":"2018-09-28T06:18:01+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538115514413_-476255312","id":"20180928-061834_1039641688","dateCreated":"2018-09-28T06:18:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1605","text":"testDF.count()","dateUpdated":"2018-09-28T06:18:42+0000","dateFinished":"2018-09-28T06:18:46+0000","dateStarted":"2018-09-28T06:18:42+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res8: Long = 7328941\n"}]}},{"text":"\n\nval joinedSampledDF = testDF.join(truthDFdup, \"maid\").select(testDF(\"maid\"),testDF(\"pack\"),truthDFdup(\"adidtype\")).persist(StorageLevel.MEMORY_ONLY_SER)","dateUpdated":"2018-09-28T06:19:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"joinedSampledDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [maid: string, pack: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1538115270954_479508573","id":"20180921-131210_1606839805","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275","user":"anonymous","dateFinished":"2018-09-28T06:19:30+0000","dateStarted":"2018-09-28T06:19:29+0000"},{"text":"joinedSampledDF.show()","dateUpdated":"2018-09-28T06:19:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------+\n|                maid|                pack|adidtype|\n+--------------------+--------------------+--------+\n|000375855C724A938...|com.apple.android...|       2|\n|0005630772384C779...|      com.rebagg.ios|       4|\n|0008E460641D44CF8...|         com.tvg.ios|       4|\n|000B31BC4FA540468...| com.9gag.ios.mobile|       4|\n|000DC0F1A66B4C1FB...|com.oasisfeng.gre...|       2|\n|000F799424C14CA99...|com.imleagues.ios...|       4|\n|000FB67D222548E2B...|com.apple.android...|       2|\n|0010C1179CEC49E69...|com.apple.android...|       2|\n|0011448E5F1D4BFCA...| com.9gag.ios.mobile|       4|\n|001527DBA38F4B50A...| com.9gag.ios.mobile|       4|\n|00178BC255F84A09B...|   com.sand.airdroid|       2|\n|0019E52A19D34BDB8...|com.apple.android...|       2|\n|001A93CA876D4320A...|com.avast.android...|       2|\n|00215C48CE30415DB...|com.apple.android...|       2|\n|0022F620BC7F48389...|     com.kasamba.ios|       4|\n|00233E8E6F774774A...| com.apple.movetoios|       2|\n|0023858BAD0F4008B...|com.avast.android...|       2|\n|00280892194745D2B...|com.imleagues.ios...|       4|\n|00280EF8E04141B48...|com.apple.android...|       2|\n|002B042B474F45C1B...|     com.newchic.ios|       4|\n+--------------------+--------------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1538115270954_479508573","id":"20180921-131230_429271626","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:276","user":"anonymous","dateFinished":"2018-09-28T06:19:50+0000","dateStarted":"2018-09-28T06:19:41+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538115601132_650243495","id":"20180928-062001_2119051730","dateCreated":"2018-09-28T06:20:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1775","text":"joinedSampledDF.count()","dateUpdated":"2018-09-28T06:20:10+0000","dateFinished":"2018-09-28T06:20:19+0000","dateStarted":"2018-09-28T06:20:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res14: Long = 6083265\n"}]}},{"text":"joinedSampledDF.createOrReplaceTempView(\"joinset\")","dateUpdated":"2018-09-28T06:20:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538115270954_479508573","id":"20180921-131333_518843024","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:277","user":"anonymous","dateFinished":"2018-09-28T06:20:23+0000","dateStarted":"2018-09-28T06:20:23+0000"},{"text":"\n\nval sq = (\"select pack as packName, count(maid) as maids_joined, sum(case when adidtype = 2 then 1 else 0 end) Android, sum(case when adidtype = 4 then 1 else 0 end) iOS from joinset group by pack\")\nval sample = spark.sql(sq)\n//sample.show()","dateUpdated":"2018-09-28T06:20:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sq: String = select pack as packName, count(maid) as maids_joined, sum(case when adidtype = 2 then 1 else 0 end) Android, sum(case when adidtype = 4 then 1 else 0 end) iOS from joinset group by pack\nsample: org.apache.spark.sql.DataFrame = [packName: string, maids_joined: bigint ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1538115270954_479508573","id":"20180921-133203_1668618327","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278","user":"anonymous","dateFinished":"2018-09-28T06:20:35+0000","dateStarted":"2018-09-28T06:20:35+0000"},{"text":"//sample.coalesce(1).write.mode(\"overwrite\").option(\"header\", \"true\").csv(\"s3a://twine-dev-athena/DeviceCharacteristics/FullSample/Weighted/weighted.csv\")\nsample.write.mode(\"overwrite\").option(\"header\", \"true\").csv(\"s3a://twine-dev-athena/DeviceCharacteristics/FullSample/Weighted/\")","dateUpdated":"2018-09-28T06:20:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538115270955_479123824","id":"20180921-134224_2017987308","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279","user":"anonymous","dateFinished":"2018-09-28T06:21:02+0000","dateStarted":"2018-09-28T06:20:49+0000"},{"dateUpdated":"2018-09-28T06:22:09+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538115270955_479123824","id":"20180921-182704_2020902013","dateCreated":"2018-09-28T06:14:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:280","text":"sample.coalesce(1).write.mode(\"overwrite\").option(\"header\", \"true\").csv(\"s3a://twine-dev-athena/DeviceCharacteristics/weighted.csv\")","user":"anonymous","dateFinished":"2018-09-28T06:22:13+0000","dateStarted":"2018-09-28T06:22:09+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538115729479_924754996","id":"20180928-062209_52454406","dateCreated":"2018-09-28T06:22:09+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1935"}],"name":"OS_Full_Sampling_Weight","id":"2DTS3SWU9","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}